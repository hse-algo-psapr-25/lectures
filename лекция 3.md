# –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã

–†–∞–Ω–µ–µ –º—ã –Ω–∞—á–∞–ª–∏ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –æ—Å–æ–±—ã–π –∫–ª–∞—Å—Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ - —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã. –ë—ã–ª–æ –æ—Ç–º–µ—á–µ–Ω–æ, —á—Ç–æ:
- –í —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–Ω—è—Ç–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏;
- –ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–¥–µ—è —Å–≤–µ–¥–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏ –∫ –æ–¥–Ω–æ–π –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ—Ö–æ–∂–∏–º –∑–∞–¥–∞—á–∞–º –º–µ–Ω—å—à–µ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ —Ç–∞–∫–æ–µ —Å–≤–µ–¥–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ);
- –ü—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —á–∞—Å—Ç–æ –≤–æ–∑–Ω–∏–∫–∞—é—Ç —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è (–∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–æ–≥–¥–∞ —É–¥–∞—ë—Ç—Å—è —Ä–µ—à–∏—Ç—å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏);
- –ü—Ä–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ä–µ–∫—É—Ä—Å–∏—é –∏–Ω–æ–≥–¥–∞ –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –∏—Ç–µ—Ä–∞—Ü–∏–µ–π (—á—Ç–æ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —É–º–µ–Ω—å—à–∞–µ—Ç –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏ –æ–±—ä—ë–º –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ø–∞–º—è—Ç–∏);
- –í—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –≤–∏–¥—ã —Ä–µ–∫—É—Ä—Å–∏–∏ - –¥–≤–æ–π–Ω–∞—è (—Ç—Ä–æ–π–Ω–∞—è) —Ä–µ–∫—É—Ä—Å–∏—è –∏ –≤–∑–∞–∏–º–Ω–∞—è —Ä–µ–∫—É—Ä—Å–∏—è.

---

–¢–µ–ø–µ—Ä—å –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä—ã —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ (–≤ —Ç–æ–º —á–∏—Å–ª–µ –¥–≤–æ–π–Ω–æ–π, —Ç—Ä–æ–π–Ω–æ–π –∏ –≤–∑–∞–∏–º–Ω–æ–π —Ä–µ–∫—É—Ä—Å–∏–∏) –∏–∑ —Ä–∞–∑–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏: –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏, –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–∏–∫–∏, –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è, —Ç–µ–æ—Ä–∏–∏ –≥—Ä–∞—Ñ–æ–≤.

## üìå –ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞. –ù–û–î.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∑–∞–¥–∞—á—É –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è $–ù–û–î(N, K)$ –Ω–∞–∏–±–æ–ª—å—à–µ–≥–æ –æ–±—â–µ–≥–æ –¥–µ–ª–∏—Ç–µ–ª—è —á–∏—Å–µ–ª $N$ –∏ $–ö$. –î–ª—è –µ—ë —Ä–µ—à–µ–Ω–∏—è —Ö–æ—Ä–æ—à–æ –∏–∑–≤–µ—Å—Ç–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª–∏–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–º —Ñ–∞–∫—Ç–µ:

$$
\text{–µ—Å–ª–∏ } N \leq K \text{, —Ç–æ } –ù–û–î(N, K) = –ù–û–î(–ö - N, N)
$$

–ö–∞–∫ –≤–∏–¥–∏–º, –≤ —ç—Ç–æ–π —Ñ–æ—Ä–º—É–ª–µ –ù–û–î –æ—Ç –¥–≤—É—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ $N$ –∏ $–ö$ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ù–û–î, –Ω–æ –æ—Ç –¥–≤—É—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ $–ö - N$ –∏ $N$. –ü–æ —Å—É—Ç–∏, —ç—Ç–æ –¥–≤–æ–π–Ω–∞—è —Ä–µ–∫—É—Ä—Å–∏—è.

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã ¬´–∑–∞–ø—É—Å—Ç–∏—Ç—å¬ª —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –Ω—É–∂–Ω–æ –µ—â—ë —É–∫–∞–∑–∞—Ç—å –±–∞–∑—É —Ä–µ–∫—É—Ä—Å–∏–∏. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –æ–Ω–∞ –∏–º–µ–µ—Ç –≤–∏–¥:

$$
–ù–û–î(0, –ö) = –ö
$$

---

–ü—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, $–ù–û–î(36,56)$ —Å–æ–≥–ª–∞—Å–Ω–æ —ç—Ç–æ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É –ø—Ä–∏–¥—ë—Ç—Å—è –ø—Ä–µ–∂–¥–µ –≤—ã—á–∏—Å–ª–∏—Ç—å $–ù–û–î(20,36)$, –∞ –¥–æ —ç—Ç–æ–≥–æ - –≤—ã—á–∏—Å–ª–∏—Ç—å $–ù–û–î(16,20)$, –∞ –ø–µ—Ä–µ–¥ —ç—Ç–∏–º - $–ù–û–î(4,16)$, $–ù–û–î(4,12)$, $–ù–û–î(4,8)$, $–ù–û–î(4,4)$ –∏ $–ù–û–î(0,4)$, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞–≤–Ω–æ 4 –∏–∑ –±–∞–∑—ã —Ä–µ–∫—É—Ä—Å–∏–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –ø–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç: $–ù–û–î(36,56) = 4$.

–û–ø–∏—Å–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ï–≤–∫–ª–∏–¥–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –µ–≥–æ ¬´–º–µ–¥–ª–µ–Ω–Ω—É—é¬ª –≤–µ—Ä—Å–∏—é, –ø–æ—Ç–æ–º—É —á—Ç–æ –µ—Å—Ç—å –µ—â—ë –∏ ¬´–±—ã—Å—Ç—Ä–∞—è¬ª –≤–µ—Ä—Å–∏—è. –û–Ω–∞ —Ç–æ–∂–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ–Ω–µ–µ –æ—á–µ–≤–∏–¥–Ω—ã–π –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—Ç:

$$
\text{–µ—Å–ª–∏ } N \leq K \text{, —Ç–æ }–ù–û–î(N, K) = –ù–û–î((–ö~mod~N), N)
$$

–≥–¥–µ $–ö mod N$ - —ç—Ç–æ –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è $–ö$ –Ω–∞ $N$.

---

–°—Ä–∞–≤–Ω–∏–º —Ä–∞–±–æ—Ç—É ¬´–º–µ–¥–ª–µ–Ω–Ω–æ–π¬ª –∏ ¬´–±—ã—Å—Ç—Ä–æ–π¬ª –≤–µ—Ä—Å–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ï–≤–∫–ª–∏–¥–∞ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ $–ù–û–î(2,99)$.

–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ ¬´–º–µ–¥–ª–µ–Ω–Ω–æ–π¬ª –≤–µ—Ä—Å–∏–∏:

$$
–ù–û–î(2,99) \longleftarrow –ù–û–î(2,97) \longleftarrow –ù–û–î(2,95) \longleftarrow –ù–û–î(2,93) \longleftarrow –ù–û–î(2,91) ‚Ä¶ \\
‚Ä¶ –ù–û–î(2,5) \longleftarrow –ù–û–î(2,3) \longleftarrow –ù–û–î(1,2) \longleftarrow –ù–û–î(1,1) \longleftarrow –ù–û–î(0,1) = 1.
$$

–ó–¥–µ—Å—å –º—ã –≤–∏–¥–∏–º, —á—Ç–æ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è $–ù–û–î(2,99)$ –Ω–∞–¥–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –ù–û–î –¥–ª—è 51 –ø–∞—Ä—ã —á–∏—Å–µ–ª, –≤–∫–ª—é—á–∞—è –±–∞–∑—É —Ä–µ–∫—É—Ä—Å–∏–∏.

–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ ¬´–±—ã—Å—Ç—Ä–æ–π¬ª –≤–µ—Ä—Å–∏–∏ –Ω–∞–º–Ω–æ–≥–æ –∫–æ—Ä–æ—á–µ:

$$
–ù–û–î(2,99) \longleftarrow –ù–û–î((99 mod 2),2) = –ù–û–î(1,2) \longleftarrow –ù–û–î((2 mod 1),1) = –ù–û–î(0,1) = 1.
$$

–ó–¥–µ—Å—å –º—ã –≤–∏–¥–∏–º, —á—Ç–æ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è $–ù–û–î(2,99)$ –Ω–∞–¥–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –ù–û–î –ª–∏—à—å –¥–ª—è –¥–≤—É—Ö –ø–∞—Ä —á–∏—Å–µ–ª, –≤–∫–ª—é—á–∞—è –±–∞–∑—É —Ä–µ–∫—É—Ä—Å–∏–∏.

–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –æ–±–µ –≤–µ—Ä—Å–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ï–≤–∫–ª–∏–¥–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –ù–û–ö - –Ω–∞–∏–º–µ–Ω—å—à–µ–≥–æ –æ–±—â–µ–≥–æ –∫—Ä–∞—Ç–Ω–æ–≥–æ –¥–≤—É—Ö —á–∏—Å–µ–ª, –µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ:

$$
–ù–û–ö(N, K) = \frac{N \cdot K} {–ù–û–î(N, K)}
$$

---

## üìå –ö–æ–º–±–∏–Ω–∞—Ç–æ—Ä–∏–∫–∞. –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏.

–û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ - —ç—Ç–æ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–≤—ã—Ö N –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã—Ö —á–∏—Å–µ–ª. –ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ä–æ–≤–Ω–æ $N!$ —Ç–∞–∫–∏—Ö –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫. –í–æ—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Å–µ 6 –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ —á–∏—Å–µ–ª 1,2,3, –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –≤ **–ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º** –ø–æ—Ä—è–¥–∫–µ:

$$
(1,2,3), (1,3,2), (2,1,3), (2,3,1), (3,1,2), (3,2,1).
$$

–ü—Ä–∏ —Ä–µ—à–µ–Ω–∏–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–¥–∞—á –º–µ—Ç–æ–¥–æ–º –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ–±–æ—Ä–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ $N!$ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫, –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏–≤ —Å–ª—É—á–∞–π–Ω–æ –∫–∞–∫—É—é-–Ω–∏–±—É–¥—å, –∏ –Ω–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–≤ –∫–∞–∫—É—é-–Ω–∏–±—É–¥—å –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫—É –¥–≤–∞–∂–¥—ã. –°—É—â–µ—Å—Ç–≤—É–µ—Ç —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–≥–æ –≤—ã—à–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ï–≤–∫–ª–∏–¥–∞ –≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –±—É–¥–µ–º –∏–º–µ—Ç—å –¥–µ–ª–æ –Ω–µ —Å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–π **—Ñ—É–Ω–∫—Ü–∏–µ–π**, –∞ —Å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–π **–ø—Ä–æ—Ü–µ–¥—É—Ä–æ–π**. –ù–∞ –ø—Ä–æ—à–ª–æ–π –ª–µ–∫—Ü–∏–∏ —É –Ω–∞—Å —É–∂–µ –±—ã–ª –ø—Ä–∏–º–µ—Ä –¥–≤—É—Ö —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä, –≤—ã–∑—ã–≤–∞—é—â–∏—Ö –≤–∑–∞–∏–º–Ω–æ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–∏—Ö –Ω–∞–±–æ—Ä —Å–∏–º–≤–æ–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–µ {0,1} —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏.

---

–†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ –∏–∑ $N$ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ $1,2,3,...,N$ –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –æ–¥–∏–Ω –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä - –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ $N$. –û–Ω–∞ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–∞–º—É —Å–µ–±—è, –Ω–æ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º $N- 1$, –∏ –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö $(N- 1)!$ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–æ–∫ –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ $1,2,3,...,N - 1$ (–Ω–∏–∂–µ –≤ —Ç–∞–±–ª–∏—Ü–µ $–¢_0$ –æ–Ω–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ):

| 1   | 2   | 3   | ... | N-2 | N-1 |
|-----|-----|-----|-----|-----|-----|
| 1   | 2   | 3   | ... | N-1 | N-2 |
| ... | ... | ... | ... | ... | ... |
| N-2 | N-1 | N-3 | ... | 2   | 1   |
| N-1 | N-2 | N-3 | ... | 2   | 1   |

---

–ó–∞—Ç–µ–º —á–∏—Å–ª–æ $N$ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É —Ç–∞–±–ª–∏—Ü—ã $T_0$ –ø–µ—Ä–µ–¥ –µ—ë –ø–µ—Ä–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ $T_1$:

| **N** | 1   | 2   | 3   | ... | N-2 | N-1 |
|:-----:|:---:|:---:|:---:|:---:|:---:|:---:|
| **N** | 1   | 2   | 3   | ... | N-1 | N-2 |
| **N** | ... | ... | ... | ... | ... | ... |
| **N** | N-2 | N-1 | N-3 | ... | 2   | 1   |
| **N** | N-1 | N-2 | N-3 | ... | 2   | 1   |

–û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã $–¢_1$ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π. –ó–∞—Ç–µ–º –≤ —Ç–∞–±–ª–∏—Ü–µ $–¢_1$ –º–µ–Ω—è—é—Ç—Å—è –º–µ—Å—Ç–∞–º–∏ –ø–µ—Ä–≤—ã–π –∏ –≤—Ç–æ—Ä–æ–π —Å—Ç–æ–ª–±–µ—Ü. –ü–æ–ª—É—á–∞–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ $–¢_2$:

| 1   | **N** | 2   | 3   | ... | N-2 | N-1 |
|:---:|:-----:|:---:|:---:|:---:|:---:|:---:|
| 1   | **N** | 2   | 3   | ... | N-1 | N-2 |
| ... | **N** | ... | ... | ... | ... | ... |
| N-2 | **N** | N-1 | N-3 | ... | 2   | 1   |
| N-1 | **N** | N-2 | N-3 | ... | 2   | 1   |

–û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –≤—Å–µ –µ—ë —Å—Ç—Ä–æ–∫–∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π –∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã $–¢_1$. –î–∞–ª–µ–µ –≤ —Ç–∞–±–ª–∏—Ü–µ $–¢_2$ –º–µ–Ω—è—é—Ç—Å—è –º–µ—Å—Ç–∞–º–∏ –≤—Ç–æ—Ä–æ–π –∏ —Ç—Ä–µ—Ç–∏–π —Å—Ç–æ–ª–±–µ—Ü –∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ $–¢_3$:

| 1   | 2   | **N** | 3   | ... | N-2 | N-1 |
|:---:|:---:|:-----:|:---:|:---:|:---:|:---:|
| 1   | 2   | **N** | 3   | ... | N-1 | N-2 |
| ... | ... | **N** | ... | ... | ... | ... |
| N-2 | N-1 | **N** | N-3 | ... | 2   | 1   |
| N-1 | N-2 | **N** | N-3 | ... | 2   | 1   |

–î–∞–ª–µ–µ –∫–∞–∂–¥–∞—è —Å–ª–µ–¥—É—é—â–∞—è —Ç–∞–±–ª–∏—Ü–∞ $–¢_{k+1}$ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ç–∞–±–ª–∏—Ü—ã $T_k$ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–æ–π $k$-–≥–æ –∏ $(k + 1)$-–≥–æ —Å—Ç–æ–ª–±—Ü–æ–≤. –ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–∞–±–ª–∏—Ü–∞ $–¢_N$ –±—É–¥–µ—Ç –∏–º–µ—Ç—å –≤–∏–¥:


| 1   | 2   | 3   | ... | N-2 | N-1 | **N** |
|:---:|:---:|:---:|:---:|:---:|:---:|:-----:|
| 1   | 2   | 3   | ... | N-1 | N-2 | **N** |
| ... | ... | ... | ... | ... | ... | **N** |
| N-2 | N-1 | N-3 | ... | 2   | 1   | **N** |
| N-1 | N-2 | N-3 | ... | 2   | 1   | **N** |

–û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü $T_1,T_2,T_3,‚Ä¶,T_N$ –ø–æ–ø–∞—Ä–Ω–æ —Ä–∞–∑–ª–∏—á–Ω—ã, —Å—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ —Ä–∞–≤–Ω–æ $N!$ –∏ –≤—Å–µ –æ–Ω–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –∏—Å–∫–æ–º—ã–µ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ —á–∏—Å–µ–ª $1,2,3,‚Ä¶,N$ (–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π –∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤).

## üìå –¢–µ–æ—Ä–∏—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è. –ö–æ–¥—ã –ì—Ä—ç—è.

–í –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –∑–µ—Ä–∫–∞–ª—å–Ω—ã–µ –∫–æ–¥—ã –ì—Ä—ç—è. –ö–æ–¥—ã –ì—Ä—ç—è —Å–ª–µ–¥—É–µ—Ç –æ—Ç–Ω–µ—Å—Ç–∏ –∫ –∫–ª–∞—Å—Å—É —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã—Ö –¥–≤–æ–∏—á–Ω—ã—Ö –∫–æ–¥–æ–≤. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—Å–µ –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ –∫–æ–¥–∞ –ì—Ä—ç—è –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –¥–ª–∏–Ω—É, –∞ —Å–∞–º–∏ –æ–Ω–∏ —Å–æ—Å—Ç–æ—è—Ç –∏–∑ 0 –∏ 1.

–ü–µ—Ä–µ—á–∏—Å–ª–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∫–æ–¥–∞ –ì—Ä—ç—è:
1. –ü–æ–ª–Ω—ã–π $n$-—Ä–∞–∑—Ä—è–¥–Ω—ã–π –∫–æ–¥ –ì—Ä—ç—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–æ–≤–Ω–æ $2^n$ –∫–æ–¥–æ–≤—ã—Ö —Å–ª–æ–≤ (—Ä–æ–≤–Ω–æ —Å—Ç–æ–ª—å–∫–æ –∂–µ —Å—Ç—Ä–æ–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–∞–±–ª–∏—Ü–∞ –±—É–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç $n$ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –ø—Ä–∏—á—ë–º –≤—Å–µ $2^n$ –Ω–∞–±–æ—Ä–æ–≤ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –≤ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ —è–≤–ª—è—é—Ç—Å—è –∫–æ–¥–æ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ –∫–æ–¥–∞ –ì—Ä—ç—è). –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è $n= 3$:

| 000 |
|:---:|
| 001 |
| 010 |
| 011 |
| 100 |
| 101 |
| 110 |
| 111 |

---

2. –°—É—â–µ—Å—Ç–≤—É–µ—Ç *—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è* –∫–æ–¥–æ–≤—ã—Ö —Å–ª–æ–≤ $n$-—Ä–∞–∑—Ä—è–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –ì—Ä—ç—è —á–∏—Å–ª–∞–º–∏ $1,2,3,‚Ä¶, 2^n$ —Ç–∞–∫–∞—è, —á—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ $—ñ$ —Å–ª–æ–≤–∞ —Å –Ω–æ–º–µ—Ä–∞–º–∏ $—ñ$ –∏ $(—ñ + 1)$ –±—É–¥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è —Ä–æ–≤–Ω–æ –≤ –æ–¥–Ω–æ–º —Ä–∞–∑—Ä—è–¥–∫–µ (—Ç.–µ. —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –•—ç–º–º–∏–Ω–≥–∞ –º–µ–∂–¥—É —Å–ª–æ–≤–∞–º–∏ —Å —Å–æ—Å–µ–¥–Ω–∏–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–æ 1), –∏ —Å–ª–æ–≤–∞ —Å –Ω–æ–º–µ—Ä–∞–º–∏ 1 –∏ $2^n$ —Ç–æ–∂–µ –±—É–¥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è —Ä–æ–≤–Ω–æ –≤ –æ–¥–Ω–æ–º —Ä–∞–∑—Ä—è–¥–µ), –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è = 3:

|  1  | 000 |
|:---:|:---:|
|  2  | 001 |
|  3  | 011 |
|  4  | 010 |
|  5  | 110 |
|  6  | 111 |
|  7  | 101 |
|  8  | 100 |

---

3. –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏ –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ –∫–æ–¥–∞ –ì—Ä—ç—è –º–æ–∂–Ω–æ –∏–∑–æ–±—Ä–∞–∑–∏—Ç—å –≤ –≤–∏–¥–µ –≤–µ—Ä—à–∏–Ω $n$-–º–µ—Ä–Ω–æ–≥–æ –µ–¥–∏–Ω–∏—á–Ω–æ–≥–æ –∫—É–±–∞ –≤ $n$-–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ (–ø—Ä–∏ —ç—Ç–æ–º —Å–∞–º–∏ –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ –±—É–¥—É—Ç –æ–∑–Ω–∞—á–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤–µ—Ä—à–∏–Ω), –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è $n = 3$:

![–∫–æ–¥ –ì—Ä—ç—è](assets/gray-code-1.png)

---

4. –ï—Å–ª–∏ –ø–µ—Ä–µ—á–∏—Å–ª—è—Ç—å –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ –∫–æ–¥–∞ –ì—Ä—ç—è –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–∏, —Ç–æ –ø–æ–ª—É—á–∏–º –æ–±—Ö–æ–¥ –ø–æ —Ä—ë–±—Ä–∞–º –≤—Å–µ—Ö –≤–µ—Ä—à–∏–Ω —ç—Ç–æ–≥–æ –≥—Ä–∞—Ñ–∞ —Ä–æ–≤–Ω–æ –ø–æ –æ–¥–Ω–æ–º—É —Ä–∞–∑—É (–¥–≤–∞–∂–¥—ã –ø–æ—Å–µ—â–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—É—é –≤–µ—Ä—à–∏–Ω—É); —Ç–∞–∫–æ–π –æ–±—Ö–æ–¥ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è *–≥–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤—ã–º —Ü–∏–∫–ª–æ–º* (–æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ –≤–æ –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∞—Ö):

![–∫–æ–¥ –ì—Ä—ç—è](assets/gray-code-2.png)

–ò–∑-–∑–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–≤–æ–π—Å—Ç–≤–∞ –∫–æ–¥–∞ –ì—Ä—ç—è –µ–≥–æ –∏–Ω–æ–≥–¥–∞ –Ω–∞–∑—ã–≤–∞—é—Ç *—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–º* –∫–æ–¥–æ–º. –û–Ω–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤ –≥—Ä–∞—Ñ–µ, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–µ–º —Å–æ–±–æ–π $n$-–º–µ—Ä–Ω—ã–π –∫—É–±, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≥–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤ —Ü–∏–∫–ª –∏ –µ–≥–æ –º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –Ω—É–º–µ—Ä–∞—Ü–∏—é —Å–ª–æ–≤ –∫–æ–¥–∞ –ì—Ä—ç—è. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –¥–∞–∂–µ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –≥–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤–∞ —Ü–∏–∫–ª–∞ –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º –≥—Ä–∞—Ñ–µ (–∞ —Ç–µ–º –±–æ–ª–µ–µ - –µ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ) - —ç—Ç–æ –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–∞—è –∑–∞–¥–∞—á–∞. –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∫–æ—Ç–æ—Ä–æ–π –¥–æ —Å–∏—Ö –ø–æ—Ä –Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞.

---

5. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ $n$-—Ä–∞–∑—Ä—è–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –ì—Ä—ç—è –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ —Å –ø–æ–º–æ—â—å—é —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã, –∑–∞–≤–∏—Å—è—â–µ–π –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ $n$ - –¥–ª–∏–Ω—ã –∫–æ–¥–æ–≤—ã—Ö —Å–ª–æ–≤. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –µ—ë –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ: –ø—É—Å—Ç—å –º—ã —É–∂–µ –ø–æ—Å—Ç—Ä–æ–∏–ª–∏ –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ $n$-—Ä–∞–∑—Ä—è–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –ì—Ä—ç—è –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–∏–ª–∏ –∏—Ö –≤ –ø–æ—Ä—è–¥–∫–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–∏:

$$
G(n) = \begin{cases}
0 \cdot G(n-1), \\
1 \cdot rev(G(n-1))
\end{cases}
$$

–≥–¥–µ $rev$ ‚Äî –æ–±—Ä–∞—â–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞.

–ë–∞–∑–∞ —Ä–µ–∫—É—Ä—Å–∏–∏ $G(1) = \\{ 0, 1 \\}$

```mermaid
flowchart TB


n_source -->|–æ—Ç—Ä–∞–∂–µ–Ω–∏–µ| n_reverse


n_source[00
01
11
10]


n_reverse[10
11
01
00]
```

```mermaid
flowchart LR

n --> n_source
n --> n_reverse
n_source --> n_plus_source
n_reverse --> n_plus_reverse
n_plus_source --> n_plus
n_plus_reverse --> n_plus


n[**n**
00
01
11
10]

n_source[00
01
11
10]


n_reverse[10
11
01
00]

n_plus_source[**0**00
**0**01
**0**11
**0**10]


n_plus_reverse[**1**10
**1**11
**1**01
**1**00]

n_plus[**n + 1**
000
001
011
010
110
111
101
100]
```

–°–ª–µ–≤–∞ - –∏–º–µ—é—â–∏–µ—Å—è –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ $n$-—Ä–∞–∑—Ä—è–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –ì—Ä—ç—è, —Å–ø—Ä–∞–≤–∞ - –∏—Å–∫–æ–º—ã–µ –∫–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞ $(n+1)$-—Ä–∞–∑—Ä—è–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –ì—Ä—ç—è, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–µ –≤ –ø–æ—Ä—è–¥–∫–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–∏. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –æ–±—ä—è—Å–Ω—è–µ—Ç, –ø–æ—á–µ–º—É –∫–æ–¥—ã –ì—Ä—ç—è –∏–Ω–æ–≥–¥–∞ –Ω–∞–∑—ã–≤–∞—é—Ç –∑–µ—Ä–∫–∞–ª—å–Ω—ã–º–∏ (–∏–ª–∏ –æ—Ç—Ä–∞–∂—ë–Ω–Ω—ã–º–∏) –∫–æ–¥–∞–º–∏.

---

## üìå –¢–µ–æ—Ä–∏—è –≥—Ä–∞—Ñ–æ–≤. –ê–ª–≥–æ—Ä–∏—Ç–º –§–ª–æ–π–¥–∞.

–í–∞–∂–Ω–æ–π –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–π –∑–∞–¥–∞—á–µ–π, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ –∏–∑—É—á–µ–Ω–Ω–æ–π –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ–æ—Ä–∏–∏ –≥—Ä–∞—Ñ–æ–≤, —è–≤–ª—è–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ –æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –ø—É—Ç–∏. –û–Ω–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –≤ —Å–µ—Ç–∏ –¥–æ—Ä–æ–≥, —Å–æ–µ–¥–∏–Ω—è—é—â–∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–∞—Å–µ–ª—ë–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤, —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ —Ç–∞–∫–æ–π –ø—É—Ç—å –∏–∑ –ø—É–Ω–∫—Ç–∞ –ê –≤ –ø—É–Ω–∫—Ç –í (–ø—Ä–æ—Ö–æ–¥—è—â–∏–π, –≤–æ–∑–º–æ–∂–Ω–æ, —á–µ—Ä–µ–∑ –¥—Ä—É–≥–∏–µ –Ω–∞—Å–µ–ª—ë–Ω–Ω—ã–µ –ø—É–Ω–∫—Ç—ã), —á—Ç–æ–±—ã —Å—É–º–º–∞—Ä–Ω–∞—è –¥–ª–∏–Ω–∞ –¥–æ—Ä–æ–≥, —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏—Ö —ç—Ç–æ—Ç –ø—É—Ç—å, –±—ã–ª–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π. –ò–Ω–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è, —á—Ç–æ–±—ã —Ç–∞–∫–æ–π –ø—É—Ç—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–ª –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –ø–µ—Ä–µ–≤–æ–∑–∫—É –≥—Ä—É–∑–∞ –∏–ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ –≥—Ä—É–∑–∞. –í—Å—ë —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∑–∞–¥–∞—á–∏ –æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –ø—É—Ç–∏.

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, —Ä–µ—à–∞—é—â–∏—Ö –∑–∞–¥–∞—á—É –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏. –ò–∑ –∫—É—Ä—Å–∞ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –Ω–∞–º –∏–∑–≤–µ—Å—Ç–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç–º –î–µ–π–∫—Å—Ç—Ä—ã. –û–¥–Ω–∞–∫–æ, —ç—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–µ–ª—å–∑—è –ø—Ä–∏–º–µ–Ω—è—Ç—å, –∫–æ–≥–¥–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏—Å—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã $D$ ¬´—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π¬ª - –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞. –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á–∞—Ö —Ç–∞–∫–æ–µ –≤–ø–æ–ª–Ω–µ –≤–æ–∑–º–æ–∂–Ω–æ. –ù–∞–ø—Ä–∏–º–µ—Ä, —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã $D$ –º–æ–≥—É—Ç –æ–∑–Ω–∞—á–∞—Ç—å –≤–µ–ª–∏—á–∏–Ω—É –ø–æ–ª—É—á–∞–µ–º–æ–π –ø—Ä–∏–±—ã–ª–∏ –∏–ª–∏ –≤—ã–ø–ª–∞—á–∏–≤–∞–µ–º–æ–≥–æ —à—Ç—Ä–∞—Ñ–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Ä–µ–±—Ä–∞, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –¥–∞–Ω–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –º–∞—Ç—Ä–∏—Ü—ã. –ó–¥–µ—Å—å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –ø—Ä–∏–±—ã–ª—å –≤—ã—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º, –∞ —à—Ç—Ä–∞—Ñ - –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º.

---

–ò–Ω–æ–≥–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –¥–æ–ø—É—Å–∫–∞—é—Ç –æ—à–∏–±–∫—É, –∏—Å–ø—Ä–∞–≤–ª—è—è –∏—Å—Ö–æ–¥–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π $D$ —Ç–∞–∫, —á—Ç–æ–±—ã –≤—Å–µ –µ—ë —ç–ª–µ–º–µ–Ω—Ç—ã —Å—Ç–∞–ª–∏ —Å—Ç—Ä–æ–≥–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏, –∏ –∑–∞—Ç–µ–º –ø—Ä–∏–º–µ–Ω—è—è –∫ –Ω–æ–≤–æ–π –º–∞—Ç—Ä–∏—Ü–µ –∞–ª–≥–æ—Ä–∏—Ç–º –î–µ–π–∫—Å—Ç—Ä—ã. –ü–æ—á–µ–º—É —Ç–∞–∫ –Ω–µ–ª—å–∑—è –¥–µ–ª–∞—Ç—å?

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä. –ü—É—Å—Ç—å –∑–∞–¥–∞–Ω–∞ –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞:

$$
D=\begin{pmatrix}
& 0 & -2 & 1 \\
& \infty & 0 & -1 \\
& \infty & \infty & 0 \\
\end{pmatrix}
$$

–°–∞–º –≥—Ä–∞—Ñ –∏–∑–æ–±—Ä–∞–∂—ë–Ω –Ω–∞ —Ä–∏—Å—É–Ω–∫–µ.

![–≥—Ä–∞—Ñ](assets/floyd-1.png)

–û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –∫—Ä–∞—Ç—á–∞–π—à–∏–π –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—É—Ç—å –∏–∑ $v_1$ –≤ $v_3$ –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É $-3$ –∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –¥—É–≥: $v_1 \longrightarrow v_2 \longrightarrow v_3$.

---

–û–¥–Ω–∞–∫–æ, –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —á–∏—Å–ª–∞ 5 –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º –º–∞—Ç—Ä–∏—Ü—ã (—á—Ç–æ–±—ã –¥–ª–∏–Ω—ã –≤—Å–µ—Ö –¥—É–≥ —Å—Ç–∞–ª–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏), –º—ã –ø–æ–ª—É—á–∏–º –≥—Ä–∞—Ñ –≤–∏–¥–∞

![–≥—Ä–∞—Ñ](assets/floyd-2.png)

–ï—Å–ª–∏ —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫ –Ω–µ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º –î–µ–π–∫—Å—Ç—Ä—ã, —Ç–æ –ø–æ–ª—É—á–∏–º, —á—Ç–æ –∫—Ä–∞—Ç—á–∞–π—à–∏–π –ø—É—Ç—å –∏–∑ $v_1$ –≤ $v_3$ –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É 6 –∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –æ–¥–Ω–æ–π –¥—É–≥–∏ $v_1 \longrightarrow v_3$ –≠—Ç–æ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–º—É –≥—Ä–∞—Ñ—É.

**–í—ã–≤–æ–¥**: –µ—Å–ª–∏ –≤ –º–∞—Ç—Ä–∏—Ü–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞, –Ω–µ–ª—å–∑—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—É –∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∫ –Ω–µ–π –∞–ª–≥–æ—Ä–∏—Ç–º –î–µ–π–∫—Å—Ç—Ä—ã! –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –§–ª–æ–π–¥–∞.

---

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –î–µ–π–∫—Å—Ç—Ä—ã, –∞–ª–≥–æ—Ä–∏—Ç–º –§–ª–æ–π–¥–∞ –Ω–∞—Ö–æ–¥–∏—Ç –∫—Ä–∞—Ç—á–∞–π—à–∏–µ –ø—É—Ç–∏ —Å—Ä–∞–∑—É –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä –≤–µ—Ä—à–∏–Ω. –ò—Å—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —è–≤–ª—è–µ—Ç—Å—è –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ $n$-–≥–æ –ø–æ—Ä—è–¥–∫–∞ $D_0$ - –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª–∏–Ω –¥—É–≥ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ $n$-–≤–µ—Ä—à–∏–Ω–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞. –°—á–∏—Ç–∞–µ—Ç—Å—è, —á—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–µ–±—Ä–∞ –∏–º–µ—é—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –±–æ–ª—å—à—É—é –¥–ª–∏–Ω—É, –∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–º —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –º–∞—Ç—Ä–∏—Ü–µ $D_0$ —Ä–∞–≤–Ω—ã $\infty$. –ú–∞—Ç—Ä–∏—Ü—ã $D_0$ –∏ $–¢_0$ –ø–æ—Ä–æ–∂–¥–∞—é—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü –ø-–≥–æ –ø–æ—Ä—è–¥–∫–∞ $D_1, T_1, D_2, T_2, ..., D_n, –¢_n$, —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π

$$
\begin{align}
& d^{(k)}_{i,j} = min \\{ d^{(k-1)}_{i,j},d^{(k-1)}_{i,k} + d^{(k-1)}_{k,j} \\} \\
& t^{(k)}_{i,j} = \begin{cases}
t^{(k-1)}_{i,j}\text{, –µ—Å–ª–∏ }d^{(k)}_{i,j}=d^{(k-1)}_{i,j},\\
t^{(k-1)}_{i,k}\text{ –∏–Ω–∞—á–µ, }
\end{cases}\\
& t^{(0)}_{i,j} = j, \\
& i,j,k =1, 2,‚Ä¶, n,
\end{align}
$$

–≥–¥–µ $d^{(k)}_{i,j}$ —ç–ª–µ–º–µ–Ω—Ç $i$-–π —Å—Ç—Ä–æ–∫–∏ $j$-–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –≤ –º–∞—Ç—Ä–∏—Ü–µ $D_k$,

$t^{(k)}_{i,j}$ —ç–ª–µ–º–µ–Ω—Ç $i$-–π —Å—Ç—Ä–æ–∫–∏ $j$-–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –≤ –º–∞—Ç—Ä–∏—Ü–µ $T_k$.

---

–î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã $—ñ$ –∏ $j$, –≥–¥–µ $—ñ \neq j$, —ç–ª–µ–º–µ–Ω—Ç $d^{(k)}_{i,j}$ —Ä–∞–≤–µ–Ω –¥–ª–∏–Ω–µ –ø—É—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –∫—Ä–∞—Ç—á–∞–π—à–∏–º —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—É—Ç–µ–π, 
–∏–¥—É—â–∏—Ö –∏–∑ –≤–µ—Ä—à–∏–Ω—ã $v_i$ –≤ –≤–µ—Ä—à–∏–Ω—É $v_j$ –∏, –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö —á–µ—Ä–µ–∑ –∫–∞–∫–∏–µ-–ª–∏–±–æ –∏–∑ –≤–µ—Ä—à–∏–Ω $v_1, v_2, ‚Ä¶, v_k$. 

–í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ —ç–ª–µ–º–µ–Ω—Ç $d^{(n)}_{i,j}$ –º–∞—Ç—Ä–∏—Ü—ã $D_n$, —Ä–∞–≤–µ–Ω –¥–ª–∏–Ω–µ –∏—Å–∫–æ–º–æ–≥–æ –∫—Ä–∞—Ç—á–∞–π—à–µ–≥–æ –ø—É—Ç–∏, –∏–¥—É—â–µ–≥–æ –∏–∑ $v_i$, –≤ $v_j$, –∏, –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ—Ö–æ–¥—è—â–µ–≥–æ —á–µ—Ä–µ–∑ –∫–∞–∫–∏–µ —É–≥–æ–¥–Ω–æ –≤–µ—Ä—à–∏–Ω—ã –≥—Ä–∞—Ñ–∞.

–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤–µ—Ä—à–∏–Ω—ã –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤–¥–æ–ª—å –∏—Å–∫–æ–º–æ–≥–æ –∫—Ä–∞—Ç—á–∞–π—à–µ–≥–æ –ø—É—Ç–∏, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –º–∞—Ç—Ä–∏—Ü—ã $T_n$. 

–≠–ª–µ–º–µ–Ω—Ç $t^{(n)}_{i,j}$ —Ä–∞–≤–µ–Ω –Ω–æ–º–µ—Ä—É –≤–µ—Ä—à–∏–Ω—ã, —Å–ª–µ–¥—É—é—â–µ–π —Å—Ä–∞–∑—É –∂–µ –∑–∞ –≤–µ—Ä—à–∏–Ω–æ–π $v_i$, –≤ –∫—Ä–∞—Ç—á–∞–π—à–µ–º –ø—É—Ç–∏ –∏–∑ $v_i$ –≤ $v_j$. 

–ù–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ $t^{(n)}_{2,5} = 6$ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ –∫—Ä–∞—Ç—á–∞–π—à–µ–º—É –ø—É—Ç–∏ –∏–∑ $v_2$ –≤ $v_5$ –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –ø–æ –¥—É–≥–µ –ø–µ—Ä–µ–π—Ç–∏ –∏–∑ $v_2$ –≤ $v_6$, –∞ –∑–∞—Ç–µ–º –ø–æ –∫—Ä–∞—Ç—á–∞–π—à–µ–º—É –ø—É—Ç–∏ –ø–æ–ø–∞—Å—Ç—å –∏–∑ $v_6$ –≤ $v_5$. 

–í —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, –∫—Ä–∞—Ç—á–∞–π—à–∏–π –ø—É—Ç—å –∏–∑ $v_6$ –≤ $v_5$ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —ç–ª–µ–º–µ–Ω—Ç–æ–º $t^{(n)}_{6,5}$. 

–ï—Å–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, $t^{(n)}_{6,5} = 4$, —Ç–æ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ –∫—Ä–∞—Ç—á–∞–π—à–µ–º—É –ø—É—Ç–∏ –∏–∑ $v_6$ –≤ $v_5$ –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–π—Ç–∏ –ø–æ –¥—É–≥–µ $[v_6,v_4]$, –∞ –∑–∞—Ç–µ–º –¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –∫—Ä–∞—Ç—á–∞–π—à–µ–º—É –ø—É—Ç–∏ –∏–∑ $v_4$ –≤ $v_5$ –∏ —Ç.–¥.

---

![–≥—Ä–∞—Ñ](assets/floyd-4.png)

–†–∞–±–æ—Ç—É –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –§–ª–æ–π–¥–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –æ—Ä–≥—Ä–∞—Ñ–∞ —Å –∑–∞–¥–∞–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ–π –¥–ª–∏–Ω –¥—É–≥

$$
D_0=\begin{pmatrix}
& 0 & 2 & 1 & -2 \\
& \infty & 0 & -1 & -1 \\
& 1 & \infty & 0& \infty  \\
& \infty & 3 & 2 & 0
\end{pmatrix}
$$

–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –î–µ–π–∫—Å—Ç—Ä—ã –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å –Ω–µ–ª—å–∑—è, —Ç.–∫. –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥—É–≥–∏ –∏–º–µ—é—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—É—é –¥–ª–∏–Ω—É.

–ú–∞—Ç—Ä–∏—Ü–∞ $–¢_0$ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∏–º–µ–µ—Ç –≤–∏–¥


$$
T_0=\begin{pmatrix}
& 1 & 2 & 3 & 4 \\
& 1 & 2 & 3 & 4 \\
& 1 & 2 & 3 & 4 \\
& 1 & 2 & 3 & 4
\end{pmatrix}
$$

–í—ã—á–∏—Å–ª—è—è —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü $D_1, T_1, D_2, T_2, D_3, T_3, D_4, T_4$, —Å –ø–æ–º–æ—â—å—é —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤—ã—à–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π, –ø–æ–ª—É—á–∞–µ–º

$$
D_1=\begin{pmatrix}
& 0 & 2 & 1 & -2 \\
& \infty & 0 & -1 & -1 \\
& 1 & 3 & 0& -1  \\
& \infty & 3 & 2 & 0
\end{pmatrix},
T_1=\begin{pmatrix}
& 1 & 2 & 3 & 4 \\
& 1 & 2 & 3 & 4 \\
& 1 & 1 & 3 & 1 \\
& 1 & 2 & 3 & 4
\end{pmatrix}
$$

–ü–æ—á–µ–º—É –∏–∑–º–µ–Ω–∏–ª—Å—è —ç–ª–µ–º–µ–Ω—Ç $d^{(1)}_{3,2}$?

$$
d^{(1)}_{3,2} = min\\{d^{(0)}_{3,2},d^{(0)}_{3,1} + d^{(0)}_{1,2} \\} = min\\{\infty, 1 + 2\\} = 3
$$

–ö–∞–∫ –≤—ã—á–∏—Å–ª–∏–ª–∏ —ç–ª–µ–º–µ–Ω—Ç $t^{(1)}_{3,2}$?

$$
t^{(1)}_{3,2} = t^{(0)}_{3,2} = 1
$$

–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:

$$
D_2=\begin{pmatrix}
& 0 & 2 & 1 & -2 \\
& \infty & 0 & -1 & -1 \\
& 1 & 3 & 0& -1  \\
& \infty & 3 & 2 & 0
\end{pmatrix},
T_2=\begin{pmatrix}
& 1 & 2 & 3 & 4 \\
& 1 & 2 & 3 & 4 \\
& 1 & 1 & 3 & 1 \\
& 1 & 2 & 3 & 4
\end{pmatrix}
$$

–ü–æ—á–µ–º—É –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è —ç–ª–µ–º–µ–Ω—Ç $d^{(2)}_{4,1}$ ?

$$
d^{(2)}_{4,1} = min\\{d^{(2)}_{4,1},d^{(1)}_{4,2} + d^{(1)}_{2,1} \\} = min\\{\infty, 3 + \infty\\} = \infty
$$

---

–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:

$$
D_3=\begin{pmatrix}
& 0 & 2 & 1 & -2 \\
& 0 & 0 & -1 & -2 \\
& 1 & 3 & 0& -1  \\
& 3 & 3 & 2 & 0
\end{pmatrix},
T_3=\begin{pmatrix}
& 1 & 2 & 3 & 4 \\
& 3 & 2 & 3 & 3 \\
& 1 & 1 & 3 & 1 \\
& 3 & 2 & 3 & 4
\end{pmatrix}
$$

–ü–æ—á–µ–º—É –∏–∑–º–µ–Ω–∏–ª—Å—è —ç–ª–µ–º–µ–Ω—Ç $d^{(3)}_{4,1}$ ?

$$
d^{(3)}_{4,1} = min\\{d^{(2)}_{4,1},d^{(2)}_{4,3} + d^{(2)}_{3,1} \\} = min\\{\infty, 2 + 1\\} = 3
$$

–ö–∞–∫ –≤—ã—á–∏—Å–ª–∏–ª–∏ —ç–ª–µ–º–µ–Ω—Ç $t^{(3)}_{4,1}$?

$$
t^{(3)}_{4,1} = t^{(2)}_{4,3} = 3
$$

–ó–∞–≤–µ—Ä—à–∞–µ–º —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:

$$
D_4=\begin{pmatrix}
& 0 & 1 & 0 & -2 \\
& 0 & 0 & -1 & -2 \\
& 1 & 2 & 0 & -1  \\
& 3 & 3 & 2 & 0
\end{pmatrix},
T_4=\begin{pmatrix}
& 1 & 4 & 4 & 4 \\
& 3 & 2 & 3 & 3 \\
& 1 & 1 & 3 & 1 \\
& 3 & 2 & 3 & 4
\end{pmatrix}
$$

–î–ª–∏–Ω—ã –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—É—Ç–µ–π —É–∫–∞–∑–∞–Ω—ã –≤ –º–∞—Ç—Ä–∏—Ü–µ $D_4$, –∞ —Å–∞–º–∏ –ø—É—Ç–∏ –Ω–µ—Ç—Ä—É–¥–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è –º–∞—Ç—Ä–∏—Ü—É $–¢_4$. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –ø–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –∫—Ä–∞—Ç—á–∞–π—à–∏–µ –ø—É—Ç–∏ (–≤ —Å–∫–æ–±–∫–∞—Ö —É–∫–∞–∑–∞–Ω—ã –∏—Ö –¥–ª–∏–Ω—ã):

$$
\begin{align}
& v_1 \longrightarrow v_4 \longrightarrow v_2 (1), v_1 \longrightarrow v_4 \longrightarrow v_3 (0), \\
& v_1 \longrightarrow v_4 (-2), v_2 \longrightarrow v_3 \longrightarrow v_1 (0), \\
& v_2 \longrightarrow v_3 (-1), v_2 \longrightarrow v_3 -> v_1 \longrightarrow v_4 (-2), \\
& v_3 \longrightarrow v_1 (1), v3 \longrightarrow v_1 \longrightarrow v_4 \longrightarrow v_2 (2),\\
& v_3 \longrightarrow v_1 \longrightarrow v_4 (-1), v_4 \longrightarrow v_3 \longrightarrow v_1 (3), \\
& v_4 \longrightarrow v_2 (3), v_4 \longrightarrow v_3 (2).
\end{align}
$$

---

–ü–æ—á–µ–º—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—Ä–∞—Ç—á–∞–π—à–∏–π –ø—É—Ç—å –∏–∑ $v_2$ –≤ $v_4$ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä—ë—Ö –¥—É–≥ $v_2 \longrightarrow v_3 -> v_1 \longrightarrow v_4$?

–°–æ–≥–ª–∞—Å–Ω–æ –º–∞—Ç—Ä–∏—Ü–µ $–¢_4$ —ç–ª–µ–º–µ–Ω—Ç $t^{(4)}_{2,4} = 3$. 

–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∏–∑ $v_2$ –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –∏–¥—Ç–∏ –≤ $v_3$. –ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫—É–¥–∞ –¥–≤–∏–≥–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ, –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç $t^{(3)}_{3,4} = 1$.

–ó–Ω–∞—á–∏—Ç –∏–∑ $v_3$ –Ω–∞–¥–æ –¥–∞–ª—å—à–µ –∏–¥—Ç–∏ –≤ $v_1$. –¢–µ–ø–µ—Ä—å –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç $t^{(2)}_{1,4} = 4$ 

–ü–æ—Å–∫–æ–ª—å–∫—É –º—ã —É–∂–µ –ø–æ–ø–∞–ª–∏ –≤ –Ω—É–∂–Ω—É—é –Ω–∞–º –≤–µ—Ä—à–∏–Ω—É v4, —Ç–æ –ø–æ–ª—É—á–∞–µ–º, —á—Ç–æ –∫—Ä–∞—Ç—á–∞–π—à–∏–π –ø—É—Ç—å –∏–∑ $v_2$ B $v_4$ –∏–º–µ–µ—Ç –≤–∏–¥:

$$
v_2 \longrightarrow v_3 -> v_1 \longrightarrow v_4
$$

–∞ –µ–≥–æ –¥–ª–∏–Ω–∞ - —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç $d^{(4)}_{2,4}$. –ü—Ä–æ–≤–µ—Ä–∫–∞: $(-1)+1+(-2)=(-2)$.

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ –¥–µ—Ä–µ–≤–æ –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö –ø—É—Ç–µ–π –æ—Ç –≤–µ—Ä—à–∏–Ω—ã $v_1$ –¥–æ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –≤–µ—Ä—à–∏–Ω –≥—Ä–∞—Ñ–∞.

![–≥—Ä–∞—Ñ](assets/floyd-3.png)

---

–û–±—Å—É–¥–∏–º –ø—Ä–æ–≥—Ä–∞–º–º–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –§–ª–æ–π–¥–∞. –î–ª—è $n$-–≤–µ—Ä—à–∏–Ω–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞ –∞–ª–≥–æ—Ä–∏—Ç–º –§–ª–æ–π–¥–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Å—Ç—Ä–æ–∏—Ç $2n$ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü $n$-–≥–æ –ø–æ—Ä—è–¥–∫–∞ $D_1, T_1, D_2, T_2, ‚Ä¶, D_n, T_n$, —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π

$$
\begin{align}
& d^{(k)}_{i,j} = min\\{d^{(k-1)}_{i,j},d^{(k-1)}_{i,k} + d^{(k-1)}_{k,j} \\} \\
& t^{(k)}_{i,j} = \begin{cases}
t^{(k-1)}_{i,j}\text{, –µ—Å–ª–∏ }d^{(k)}_{i,j}=d^{(k-1)}_{i,j},\\
t^{(k-1)}_{i,k}\text{ –∏–Ω–∞—á–µ, }
\end{cases}\\
& t^{(0)}_{i,j} = j, \\
& i,j,k =1, 2,‚Ä¶, n,
\end{align}
$$


–≥–¥–µ $d^{(k)}_{i,j}$ —ç–ª–µ–º–µ–Ω—Ç $i$-–π —Å—Ç—Ä–æ–∫–∏ $j$-–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –≤ –º–∞—Ç—Ä–∏—Ü–µ $D_k$,

$t^{(k)}_{i,j}$ —ç–ª–µ–º–µ–Ω—Ç $i$-–π —Å—Ç—Ä–æ–∫–∏ $j$-–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –≤ –º–∞—Ç—Ä–∏—Ü–µ $T_k$.

–û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–æ–∂–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –∏—Ç–µ—Ä–∞—Ü–∏–∏. –û–¥–Ω–∞–∫–æ, —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –º–æ–∂–Ω–æ –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏, –æ–¥–∏–Ω –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –±–æ–ª–µ–µ —ç–∫–æ–Ω–æ–º–Ω–æ —Ä–∞—Å—Ö–æ–¥—É–µ—Ç –ø–∞–º—è—Ç—å.

---

–ü–µ—Ä–≤—ã–π (–º–µ–Ω–µ–µ —ç–∫–æ–Ω–æ–º–Ω—ã–π) —Å–ø–æ—Å–æ–± —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–≤–∞ *—Ç—Ä—ë—Ö–º–µ—Ä–Ω—ã—Ö* –º–∞—Å—Å–∏–≤–∞ $D(i,j,k)$ –∏ $T(i,j,k)$, –≥–¥–µ $i,j,k=1,2,‚Ä¶,n$. –û–±–∞ –º–∞—Å—Å–∏–≤–∞ —Å–æ—Å—Ç–æ—è—Ç –∏–∑ $n^3$ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –ø—Ä–∏—á—ë–º $D$ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ –º–∞—Ç—Ä–∏—Ü—ã $D_1, D_2, ‚Ä¶, D_n$, –∞ –º–∞—Å—Å–∏–≤ $T$ - –º–∞—Ç—Ä–∏—Ü—ã $T_1, –¢_2, ‚Ä¶, –¢_n$. –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö $n$ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤ $D$ –∏ $–¢$ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–º–∞ –ø–∞–º—è—Ç–∏.

–í—Ç–æ—Ä–æ–π (–±–æ–ª–µ–µ —ç–∫–æ–Ω–æ–º–Ω—ã–π) —Å–ø–æ—Å–æ–± –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤–∞ —Ñ–∞–∫—Ç–∞:
1. –û—Ç–≤–µ—Ç –∫ –∑–∞–¥–∞—á–µ –≤—Å–µ–≥–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ –¥–≤—É—Ö –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–∞—Ç—Ä–∏—Ü–∞—Ö $D_n$, $–¢_n$, –ø—Ä–∏—á–µ–º –¥–ª–∏–Ω—ã –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö –ø—É—Ç–µ–π —É–∫–∞–∑–∞–Ω—ã –≤ –º–∞—Ç—Ä–∏—Ü–µ $D_n$, –∞ –∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ - –≤ –º–∞—Ç—Ä–∏—Ü–µ $–¢_n$;
2. –ö–∞–∂–¥–∞—è –ø–æ—Å–ª–µ–¥—É—é—â–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –≤ —Ä—è–¥—É $D_1, D_2, ‚Ä¶, D_n$, –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –ø—Ä–µ–¥—ã–¥—É—â—É—é –º–∞—Ç—Ä–∏—Ü—É —ç—Ç–æ–≥–æ —Ä—è–¥–∞, –∏ –∫–∞–∂–¥–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –≤ —Ä—è–¥—É $T_1, –¢_2, ‚Ä¶, T_n$ —Ç–∞–∫–∂–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –ø—Ä–µ–¥—ã–¥—É—â—É—é –º–∞—Ç—Ä–∏—Ü—É —ç—Ç–æ–≥–æ —Ä—è–¥–∞.

---

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –æ–±–∞ —Ä—è–¥–∞ –º–∞—Ç—Ä–∏—Ü $D_1, D_2, ‚Ä¶, D_n, –∏ T_1, T_2,..., T_n$, –∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏—à—å 4 –¥–≤—É–º–µ—Ä–Ω—ã—Ö –º–∞—Å—Å–∏–≤–∞ $D_{old}$, $D_{new}$, $T_{old}$, $T_{new}$ - –ú–∞—Å—Å–∏–≤—ã $D_{new}$ –∏ $T_{new}$ –±—É–¥—É—Ç –≤—ã—á–∏—Å–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ $D_{old}$ –∏ $T_{old}$ —Å –ø–æ–º–æ—â—å—é —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π, –∞ –∑–∞—Ç–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ –º–∞—Å—Å–∏–≤–æ–≤ $D_{new}$ –∏ $T_{new}$ –±—É–¥—É—Ç –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å—Å—è –≤ –º–∞—Å—Å–∏–≤—ã $D_{old}$ –∏ $T_{old}$.

–¢–∞–∫–æ–π –ø—Ä–∏—ë–º –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–º–µ–Ω–∏—Ç—å –¥–≤—É–º–µ—Ä–Ω—É—é —Ä–µ–∫—É—Ä—Å–∏—é –æ–¥–Ω–æ–º–µ—Ä–Ω–æ–π, –∞ —Ç—Ä—ë—Ö–º–µ—Ä–Ω—É—é - –¥–≤—É–º–µ—Ä–Ω–æ–π –∏ —Ç.–¥. –ï–≥–æ –º–æ–∂–Ω–æ (–∏ –Ω—É–∂–Ω–æ) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –∫–æ–¥–∞ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≥–ª—É–±–∏–Ω—É (—Ç.–Ω. –≥–ª—É–±–∏–Ω—É —Ä–µ–∫—É—Ä—Å–∏–∏). –î–ª—è –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–π –∏ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ –≥–ª—É–±–∏–Ω–∞ —Ä–µ–∫—É—Ä—Å–∏–∏ —Ä–∞–≤–Ω–∞ 1, –∞ –¥–ª—è —á–∏—Å–µ–ª –§–∏–±–æ–Ω–∞—á—á–∏ - 2. ¬´–ì–ª—É–±–∏–Ω–∞ —Ä–µ–∫—É—Ä—Å–∏–∏¬ª –ø–æ —Å—É—Ç–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –≥–ª—É–±–∏–Ω–æ–π —Å—Ç–µ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∏—Ç–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–º –∫–æ–¥–µ.
